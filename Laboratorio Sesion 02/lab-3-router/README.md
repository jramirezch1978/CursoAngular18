# üõ£Ô∏è LAB 3: ANGULAR ROUTER - CONFIGURACI√ìN B√ÅSICA
**‚è±Ô∏è Duraci√≥n: 30 minutos | üéØ Nivel: Intermedio**

---

## üìã DESCRIPCI√ìN

Angular Router es como el sistema de navegaci√≥n GPS de una ciudad moderna. As√≠ como un GPS conoce todas las calles y puede llevarte de cualquier punto A a cualquier punto B de manera eficiente, Angular Router conoce todos los componentes de tu aplicaci√≥n y puede mostrar el correcto seg√∫n la URL que el usuario visite.

**Analog√≠a del sistema de transporte urbano:**
- **Rutas b√°sicas:** Como las l√≠neas principales del metro - conectan destinos importantes
- **Rutas parametrizadas:** Como buses con rutas flexibles que pueden parar en diferentes ubicaciones
- **Navigation component:** Como las se√±alizaciones que te indican d√≥nde est√°s y hacia d√≥nde puedes ir
- **404 handling:** Como tener mapas actualizados que te redirigen cuando una calle no existe

En este laboratorio transformar√°s tu aplicaci√≥n de componentes individuales en una verdadera Single Page Application con navegaci√≥n fluida y profesional.

---

## üéØ OBJETIVOS DE APRENDIZAJE

Al completar este laboratorio, ser√°s capaz de:

‚úÖ **Configurar rutas b√°sicas de Angular Router**
- Definir rutas principales para diferentes secciones
- Implementar redirecciones autom√°ticas y rutas por defecto
- Configurar t√≠tulos din√°micos de p√°gina

‚úÖ **Implementar rutas parametrizadas din√°micas**
- Crear rutas que aceptan par√°metros (ej: /users/:id)
- Acceder y utilizar par√°metros de ruta en componentes
- Manejar par√°metros opcionales y query parameters

‚úÖ **Crear sistema de navegaci√≥n profesional**
- Desarrollar navigation component con RouterLink
- Implementar RouterLinkActive para estados visuales
- Crear breadcrumb navigation din√°mico

‚úÖ **Manejar rutas no encontradas (404)**
- Configurar wildcard routes para casos no contemplados
- Crear p√°gina 404 user-friendly con opciones de navegaci√≥n
- Implementar redirecciones inteligentes

---

## üß† CONCEPTOS CLAVE

### üõ£Ô∏è ¬øQu√© es Angular Router?

**Angular Router** es el sistema de navegaci√≥n oficial de Angular que permite crear Single Page Applications (SPAs) con m√∫ltiples vistas. En lugar de recargar p√°ginas completas como las aplicaciones web tradicionales, Angular Router actualiza din√°micamente el contenido de la p√°gina.

#### Ventajas de SPA con Angular Router:
```typescript
// ‚úÖ Navegaci√≥n instant√°nea
// Sin recarga de p√°gina ‚Üí Experiencia fluida como app m√≥vil

// ‚úÖ Estado preservado
// Variables, forms, scroll position se mantienen

// ‚úÖ Mejor UX
// Transiciones suaves, menos tiempo de carga

// ‚úÖ SEO y bookmarking
// URLs espec√≠ficas para cada vista
```

### üó∫Ô∏è Estructura de Rutas Angular

#### Configuraci√≥n b√°sica de rutas:
```typescript
// app.routes.ts
export const routes: Routes = [
  { path: '', redirectTo: '/dashboard', pathMatch: 'full' },
  { path: 'dashboard', component: DashboardComponent },
  { path: 'users', component: UsersComponent },
  { path: 'users/:id', component: UserDetailComponent },
  { path: '404', component: NotFoundComponent },
  { path: '**', redirectTo: '/404' }
];
```

#### Tipos de rutas:

| Tipo | Ejemplo | Descripci√≥n |
|------|---------|-------------|
| **B√°sica** | `/dashboard` | Ruta fija hacia un componente |
| **Parametrizada** | `/users/:id` | Ruta con par√°metros din√°micos |
| **Redirect** | `{ path: '', redirectTo: '/home' }` | Redirecci√≥n autom√°tica |
| **Wildcard** | `{ path: '**', component: NotFound }` | Captura todas las rutas no definidas |

---

## üìö FUNDAMENTOS TE√ìRICOS

### üîç Anatom√≠a del Angular Router

#### 1. Route Configuration
```typescript
interface Route {
  path?: string;              // URL pattern
  component?: Type<any>;      // Componente a mostrar
  redirectTo?: string;        // Redirecci√≥n
  pathMatch?: string;         // Estrategia de matching
  title?: string;            // T√≠tulo de la p√°gina
  data?: any;                // Datos est√°ticos
  resolve?: any;             // Data resolvers
  canActivate?: any[];       // Guards de activaci√≥n
}
```

#### 2. RouterOutlet
```html
<!-- router-outlet es donde se renderizan los componentes -->
<div class="app-layout">
  <header>Navigation</header>
  <main>
    <router-outlet></router-outlet> <!-- Aqu√≠ aparecen los componentes -->
  </main>
  <footer>Footer</footer>
</div>
```

#### 3. Navigation Directives
```html
<!-- RouterLink: navegaci√≥n declarativa -->
<a routerLink="/users">Usuarios</a>
<a [routerLink]="['/users', userId]">Usuario espec√≠fico</a>

<!-- RouterLinkActive: estado visual activo -->
<a routerLink="/dashboard" routerLinkActive="active">Dashboard</a>
```

#### 4. Programmatic Navigation
```typescript
// Router service: navegaci√≥n program√°tica
constructor(private router: Router) {}

navigateToUser(id: number) {
  this.router.navigate(['/users', id]);
}

// Con query parameters y fragments
this.router.navigate(['/users'], { 
  queryParams: { page: 2, sort: 'name' },
  fragment: 'top'
});
```

### üéØ Par√°metros de Ruta

#### Acceder a par√°metros:
```typescript
// ActivatedRoute: informaci√≥n de la ruta actual
constructor(private route: ActivatedRoute) {}

ngOnInit() {
  // Par√°metros de ruta (/users/:id)
  const id = this.route.snapshot.params['id'];
  
  // Observable para cambios din√°micos
  this.route.params.subscribe(params => {
    const id = params['id'];
    this.loadUser(id);
  });
  
  // Query parameters (?page=2&sort=name)
  this.route.queryParams.subscribe(queryParams => {
    const page = queryParams['page'];
    const sort = queryParams['sort'];
  });
}
```

---

## üõ†Ô∏è IMPLEMENTACI√ìN PASO A PASO

### PASO 1: Configurar Rutas Principales (8 minutos)

#### 1.1 Crear componentes de p√°ginas
```bash
# Crear p√°ginas principales en carpeta pages
ng generate component pages/dashboard --standalone
ng generate component pages/users --standalone  
ng generate component pages/projects --standalone
ng generate component pages/not-found --standalone
```

#### 1.2 Configurar app.routes.ts

**Archivo: `src/app/app.routes.ts`**
```typescript
import { Routes } from '@angular/router';
import { DashboardComponent } from './pages/dashboard/dashboard.component';
import { UsersComponent } from './pages/users/users.component';
import { ProjectsComponent } from './pages/projects/projects.component';
import { NotFoundComponent } from './pages/not-found/not-found.component';

/**
 * üõ£Ô∏è Configuraci√≥n de rutas principales de la aplicaci√≥n
 * Define c√≥mo Angular Router mapea URLs a componentes
 */
export const routes: Routes = [
  // üè† Ruta ra√≠z - redirige al dashboard
  { 
    path: '', 
    redirectTo: '/dashboard', 
    pathMatch: 'full' 
  },
  
  // üìä Dashboard principal
  { 
    path: 'dashboard', 
    component: DashboardComponent,
    title: 'Dashboard - PROVIAS',
    data: { 
      breadcrumb: 'Dashboard',
      description: 'Panel principal con estad√≠sticas y accesos r√°pidos'
    }
  },
  
  // üë• Gesti√≥n de usuarios
  { 
    path: 'users', 
    component: UsersComponent,
    title: 'Gesti√≥n de Usuarios - PROVIAS',
    data: { 
      breadcrumb: 'Usuarios',
      description: 'Administraci√≥n completa de usuarios del sistema'
    }
  },
  
  // üë§ Detalle espec√≠fico de usuario (ruta parametrizada)
  { 
    path: 'users/:id', 
    component: UsersComponent,
    title: 'Detalle de Usuario - PROVIAS',
    data: { 
      breadcrumb: 'Detalle Usuario',
      description: 'Informaci√≥n detallada de un usuario espec√≠fico'
    }
  },
  
  // üèóÔ∏è Gesti√≥n de proyectos
  { 
    path: 'projects', 
    component: ProjectsComponent,
    title: 'Proyectos - PROVIAS',
    data: { 
      breadcrumb: 'Proyectos',
      description: 'Administraci√≥n de proyectos de infraestructura'
    }
  },
  
  // üìã Detalle espec√≠fico de proyecto (ruta parametrizada)
  { 
    path: 'projects/:id', 
    component: ProjectsComponent,
    title: 'Detalle de Proyecto - PROVIAS',
    data: { 
      breadcrumb: 'Detalle Proyecto',
      description: 'Informaci√≥n detallada de un proyecto espec√≠fico'
    }
  },
  
  // üöß P√°gina 404 personalizada
  { 
    path: '404', 
    component: NotFoundComponent,
    title: 'P√°gina no encontrada - PROVIAS',
    data: { 
      breadcrumb: '404',
      description: 'La p√°gina solicitada no existe'
    }
  },
  
  // ‚≠ê Wildcard route - debe ser la √∫ltima
  // Captura todas las rutas no definidas y redirige a 404
  { 
    path: '**', 
    redirectTo: '/404' 
  }
];
```

---

### PASO 2: Crear Navigation Component (10 minutos)

#### 2.1 Generar componente de navegaci√≥n
```bash
# Crear componente de navegaci√≥n en shared
ng generate component shared/navigation --standalone
```

#### 2.2 Implementar navigation.component.ts

**Archivo: `src/app/shared/navigation/navigation.component.ts`**
```typescript
import { Component, OnInit, OnDestroy } from '@angular/core';
import { CommonModule } from '@angular/common';
import { Router, RouterLink, RouterLinkActive, NavigationEnd, ActivatedRoute } from '@angular/router';
import { filter, map } from 'rxjs/operators';
import { Subscription } from 'rxjs';
import { LoggerService } from '../../services/logger.service';

/**
 * üß≠ Interface para definir elementos de navegaci√≥n
 */
interface NavItem {
  path: string;           // Ruta de destino
  label: string;          // Texto a mostrar
  icon: string;          // Emoji o icono
  exactMatch?: boolean;   // Matching exacto para RouterLinkActive
  description?: string;   // Descripci√≥n tooltip
  badge?: string;        // Badge opcional (ej: "Nuevo")
}

/**
 * üìç Interface para breadcrumb items
 */
interface BreadcrumbItem {
  label: string;
  url: string;
  isActive: boolean;
}

@Component({
  selector: 'app-navigation',
  standalone: true,
  imports: [CommonModule, RouterLink, RouterLinkActive],
  templateUrl: './navigation.component.html',
  styleUrl: './navigation.component.scss'
})
export class NavigationComponent implements OnInit, OnDestroy {
  
  // üß≠ Elementos de navegaci√≥n principal
  navItems: NavItem[] = [
    { 
      path: '/dashboard', 
      label: 'Dashboard', 
      icon: 'üìä', 
      exactMatch: true,
      description: 'Panel principal con estad√≠sticas'
    },
    { 
      path: '/users', 
      label: 'Usuarios', 
      icon: 'üë•',
      description: 'Gesti√≥n de usuarios del sistema'
    },
    { 
      path: '/projects', 
      label: 'Proyectos', 
      icon: 'üèóÔ∏è',
      description: 'Administraci√≥n de proyectos'
    }
  ];

  // üìç Estado de navegaci√≥n
  currentRoute = '';
  breadcrumbs: BreadcrumbItem[] = [];
  
  // üîÑ Gesti√≥n de subscripciones
  private routerSubscription = new Subscription();

  constructor(
    private router: Router,
    private activatedRoute: ActivatedRoute,
    private logger: LoggerService
  ) {}

  ngOnInit(): void {
    this.logger.info('NavigationComponent', 'Componente de navegaci√≥n inicializado');
    this.subscribeToRouterEvents();
    this.updateCurrentRoute(this.router.url);
  }

  ngOnDestroy(): void {
    this.logger.info('NavigationComponent', 'Destruyendo componente de navegaci√≥n');
    this.routerSubscription.unsubscribe();
  }

  // üîÑ Suscripci√≥n a eventos del router

  /**
   * üì° Suscribirse a cambios de ruta para actualizar estado
   */
  private subscribeToRouterEvents(): void {
    const navigationSubscription = this.router.events
      .pipe(
        filter(event => event instanceof NavigationEnd),
        map(event => event as NavigationEnd)
      )
      .subscribe((event: NavigationEnd) => {
        this.updateCurrentRoute(event.urlAfterRedirects);
        this.updateBreadcrumbs();
        
        this.logger.info('NavigationComponent', `Navegaci√≥n completada: ${event.urlAfterRedirects}`, {
          url: event.urlAfterRedirects,
          previousUrl: event.url
        });
      });
    
    this.routerSubscription.add(navigationSubscription);
  }

  /**
   * üéØ Actualizar ruta actual
   */
  private updateCurrentRoute(url: string): void {
    this.currentRoute = url;
    this.logger.debug('NavigationComponent', `Ruta actualizada: ${url}`);
  }

  /**
   * üìç Generar breadcrumbs din√°micos
   */
  private updateBreadcrumbs(): void {
    this.breadcrumbs = [];
    
    // Siempre incluir Dashboard como base
    this.breadcrumbs.push({
      label: 'Dashboard',
      url: '/dashboard',
      isActive: this.currentRoute === '/dashboard' || this.currentRoute === '/'
    });
    
    // Analizar ruta actual para construir breadcrumbs
    const urlSegments = this.currentRoute.split('/').filter(segment => segment);
    
    if (urlSegments.length > 1) {
      const mainSection = urlSegments[1];
      
      // Agregar secci√≥n principal
      switch (mainSection) {
        case 'users':
          this.breadcrumbs.push({
            label: 'Usuarios',
            url: '/users',
            isActive: urlSegments.length === 2
          });
          
          // Si hay ID espec√≠fico
          if (urlSegments.length === 3) {
            this.breadcrumbs.push({
              label: `Usuario #${urlSegments[2]}`,
              url: this.currentRoute,
              isActive: true
            });
          }
          break;
          
        case 'projects':
          this.breadcrumbs.push({
            label: 'Proyectos',
            url: '/projects',
            isActive: urlSegments.length === 2
          });
          
          // Si hay ID espec√≠fico
          if (urlSegments.length === 3) {
            this.breadcrumbs.push({
              label: `Proyecto #${urlSegments[2]}`,
              url: this.currentRoute,
              isActive: true
            });
          }
          break;
          
        case '404':
          this.breadcrumbs.push({
            label: 'P√°gina no encontrada',
            url: '/404',
            isActive: true
          });
          break;
      }
    }
    
    this.logger.debug('NavigationComponent', 'Breadcrumbs actualizados', this.breadcrumbs);
  }

  // üéÆ M√©todos de navegaci√≥n

  /**
   * üß≠ Navegaci√≥n program√°tica
   */
  navigateTo(path: string): void {
    this.logger.info('NavigationComponent', `Navegando program√°ticamente a: ${path}`);
    this.router.navigate([path]);
  }

  /**
   * ‚úÖ Verificar si una ruta est√° activa
   */
  isActive(path: string): boolean {
    if (path === '/dashboard') {
      // Dashboard es activo solo si estamos exactamente en / o /dashboard
      return this.currentRoute === '/' || this.currentRoute === '/dashboard';
    }
    // Para otras rutas, verificar si la ruta actual comienza con el path
    return this.currentRoute.startsWith(path);
  }

  /**
   * üéØ Obtener clase CSS para elemento de navegaci√≥n activo
   */
  getNavItemClass(item: NavItem): string {
    const baseClasses = ['nav-link'];
    
    if (this.isActive(item.path)) {
      baseClasses.push('active');
    }
    
    return baseClasses.join(' ');
  }

  /**
   * üìç Navegaci√≥n via breadcrumb
   */
  navigateToBreadcrumb(breadcrumb: BreadcrumbItem): void {
    if (!breadcrumb.isActive) {
      this.logger.info('NavigationComponent', `Navegando via breadcrumb: ${breadcrumb.url}`);
      this.router.navigate([breadcrumb.url]);
    }
  }

  /**
   * üè† Ir al inicio (Dashboard)
   */
  goHome(): void {
    this.navigateTo('/dashboard');
  }

  /**
   * ‚Üê Ir atr√°s en el historial
   */
  goBack(): void {
    window.history.back();
    this.logger.info('NavigationComponent', 'Navegaci√≥n hacia atr√°s usando history.back()');
  }

  /**
   * üîç Buscar y navegar (funcionalidad futura)
   */
  searchAndNavigate(query: string): void {
    // Funcionalidad de b√∫squeda que se puede implementar m√°s adelante
    this.logger.info('NavigationComponent', `B√∫squeda solicitada: ${query}`);
    
    // Ejemplo de l√≥gica de b√∫squeda inteligente
    if (query.toLowerCase().includes('usuario')) {
      this.navigateTo('/users');
    } else if (query.toLowerCase().includes('proyecto')) {
      this.navigateTo('/projects');
    } else {
      // Buscar por ID num√©rico
      const id = parseInt(query);
      if (!isNaN(id)) {
        // Asumir que es un ID de usuario si es menor a 1000
        if (id < 1000) {
          this.navigateTo(`/users/${id}`);
        } else {
          this.navigateTo(`/projects/${id}`);
        }
      }
    }
  }

  // üé® M√©todos de utilidad para el template

  /**
   * üìä Obtener informaci√≥n de la ruta actual
   */
  getCurrentRouteInfo(): any {
    return {
      url: this.currentRoute,
      segments: this.currentRoute.split('/').filter(s => s),
      breadcrumbsCount: this.breadcrumbs.length,
      isHomePage: this.currentRoute === '/' || this.currentRoute === '/dashboard'
    };
  }

  /**
   * üéØ Verificar si hay navegaci√≥n disponible hacia atr√°s
   */
  canGoBack(): boolean {
    return window.history.length > 1;
  }
}
```

#### 2.3 Crear template navigation.component.html

**Archivo: `src/app/shared/navigation/navigation.component.html`**
```html
<nav class="main-navigation">
  <!-- üè¢ Brand/Logo section -->
  <div class="nav-brand">
    <button class="brand-link" (click)="goHome()">
      <h2>üèóÔ∏è PROVIAS</h2>
      <span class="nav-subtitle">Sistema de Gesti√≥n v18</span>
    </button>
  </div>

  <!-- üìç Breadcrumb navigation -->
  <div class="breadcrumb-section">
    <nav class="breadcrumb" aria-label="Breadcrumb">
      @for (breadcrumb of breadcrumbs; track breadcrumb.url; let isLast = $last) {
        <span class="breadcrumb-item" [class.active]="breadcrumb.isActive">
          @if (!breadcrumb.isActive) {
            <button 
              class="breadcrumb-link"
              (click)="navigateToBreadcrumb(breadcrumb)"
              [title]="'Ir a ' + breadcrumb.label">
              {{ breadcrumb.label }}
            </button>
          } @else {
            <span class="breadcrumb-current">{{ breadcrumb.label }}</span>
          }
          
          @if (!isLast) {
            <span class="breadcrumb-separator">‚Ä∫</span>
          }
        </span>
      }
    </nav>
  </div>

  <!-- üß≠ Main navigation menu -->
  <ul class="nav-menu">
    @for (item of navItems; track item.path) {
      <li class="nav-item">
        <a 
          [routerLink]="item.path"
          routerLinkActive="active"
          [routerLinkActiveOptions]="{ exact: item.exactMatch || false }"
          class="nav-link"
          [title]="item.description"
          [attr.aria-label]="item.label">
          
          <span class="nav-icon">{{ item.icon }}</span>
          <span class="nav-label">{{ item.label }}</span>
          
          @if (item.badge) {
            <span class="nav-badge">{{ item.badge }}</span>
          }
        </a>
      </li>
    }
  </ul>

  <!-- üîß Navigation utilities -->
  <div class="nav-utilities">
    <!-- Back button -->
    @if (canGoBack() && currentRoute !== '/' && currentRoute !== '/dashboard') {
      <button 
        class="utility-btn back-btn"
        (click)="goBack()"
        title="Ir atr√°s">
        ‚Üê Atr√°s
      </button>
    }
    
    <!-- Quick search (funcionalidad futura) -->
    <div class="quick-search">
      <input 
        type="text" 
        class="search-input"
        placeholder="Buscar (ej: usuario 123)"
        #searchInput
        (keyup.enter)="searchAndNavigate(searchInput.value)">
      <button 
        class="search-btn"
        (click)="searchAndNavigate(searchInput.value)"
        title="Buscar">
        üîç
      </button>
    </div>
  </div>

  <!-- üìä Route information panel (para desarrollo/debug) -->
  <div class="route-info-panel">
    <h4>üìç Informaci√≥n de Ruta</h4>
    <div class="route-details">
      <div class="route-detail">
        <span class="detail-label">URL actual:</span>
        <code class="detail-value">{{ currentRoute || '/' }}</code>
      </div>
      
      <div class="route-detail">
        <span class="detail-label">Segmentos:</span>
        <span class="detail-value">{{ getCurrentRouteInfo().segments.length }}</span>
      </div>
      
      <div class="route-detail">
        <span class="detail-label">Breadcrumbs:</span>
        <span class="detail-value">{{ breadcrumbs.length }}</span>
      </div>
    </div>
    
    <!-- Demo de navegaci√≥n program√°tica -->
    <div class="navigation-demo">
      <h5>üéÆ Demo de Navegaci√≥n</h5>
      <div class="demo-buttons">
        <button class="demo-btn" (click)="navigateTo('/dashboard')">
          üìä Dashboard
        </button>
        <button class="demo-btn" (click)="navigateTo('/users')">
          üë• Usuarios
        </button>
        <button class="demo-btn" (click)="navigateTo('/users/123')">
          üë§ Usuario #123
        </button>
        <button class="demo-btn" (click)="navigateTo('/projects')">
          üèóÔ∏è Proyectos
        </button>
        <button class="demo-btn" (click)="navigateTo('/invalid-route')">
          üöß Ruta inv√°lida (404)
        </button>
      </div>
    </div>
  </div>

  <!-- üí° Informaci√≥n educativa sobre routing -->
  <div class="routing-concepts">
    <h4>üí° Conceptos de Angular Router</h4>
    <div class="concepts-list">
      <div class="concept-item">
        <span class="concept-icon">üõ£Ô∏è</span>
        <div class="concept-content">
          <strong>RouterLink:</strong>
          <p>Navegaci√≥n declarativa en templates</p>
        </div>
      </div>
      
      <div class="concept-item">
        <span class="concept-icon">üéØ</span>
        <div class="concept-content">
          <strong>RouterLinkActive:</strong>
          <p>Estado visual para enlaces activos</p>
        </div>
      </div>
      
      <div class="concept-item">
        <span class="concept-icon">üîß</span>
        <div class="concept-content">
          <strong>Router.navigate():</strong>
          <p>Navegaci√≥n program√°tica desde c√≥digo</p>
        </div>
      </div>
      
      <div class="concept-item">
        <span class="concept-icon">üìç</span>
        <div class="concept-content">
          <strong>ActivatedRoute:</strong>
          <p>Informaci√≥n de la ruta actual y par√°metros</p>
        </div>
      </div>
    </div>
  </div>
</nav>
```

¬øTe gustar√≠a que contin√∫e con los estilos del Navigation component y los componentes de p√°ginas restantes del LAB 3?