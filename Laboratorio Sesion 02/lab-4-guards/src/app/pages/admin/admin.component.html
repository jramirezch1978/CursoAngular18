<div class="admin-container">
  <!-- ğŸ‘‘ Header del panel admin -->
  <header class="admin-header">
    <div class="header-content">
      <div class="admin-info">
        <h1>ğŸ‘‘ Panel de AdministraciÃ³n</h1>
        <p class="welcome-text">
          Bienvenido, <strong>{{ currentUser?.fullName }}</strong>
        </p>
        <p class="role-info">
          Rol: {{ currentUser?.role }} | 
          Permisos: {{ currentUser?.permissions.length }} activos
        </p>
      </div>
      
      <div class="header-actions">
        <button class="action-btn secondary" (click)="refreshData()" title="Refrescar datos">
          ğŸ”„ Refrescar
        </button>
        <button class="action-btn primary" (click)="goToDashboard()" title="Ir al dashboard">
          ğŸ  Dashboard
        </button>
        <button class="action-btn danger" (click)="logout()" title="Cerrar sesiÃ³n">
          ğŸšª Salir
        </button>
      </div>
    </div>
  </header>

  <!-- ğŸ“Š EstadÃ­sticas del sistema -->
  <section class="stats-section">
    <h2>ğŸ“Š EstadÃ­sticas del Sistema</h2>
    
    <div class="stats-grid">
      @for (stat of systemStats; track stat.label) {
        <div class="stat-card" [style.border-left-color]="stat.color">
          <div class="stat-icon">{{ stat.icon }}</div>
          <div class="stat-info">
            <h3 class="stat-value">{{ stat.value }}</h3>
            <p class="stat-label">{{ stat.label }}</p>
          </div>
        </div>
      }
    </div>
  </section>

  <div class="admin-layout">
    <!-- âš™ï¸ Acciones administrativas -->
    <section class="actions-section">
      <h2>âš™ï¸ Acciones Administrativas</h2>
      
      <!-- Acciones disponibles -->
      <div class="actions-group">
        <h3>âœ… Acciones Disponibles</h3>
        <div class="actions-grid">
          @for (action of getAvailableActions(); track action.title) {
            <div 
              class="action-card available" 
              [style.border-left-color]="action.color"
              (click)="action.action()">
              
              <div class="action-icon">{{ action.icon }}</div>
              <div class="action-content">
                <h4 class="action-title">{{ action.title }}</h4>
                <p class="action-description">{{ action.description }}</p>
              </div>
              <div class="action-arrow">â¡ï¸</div>
            </div>
          }
        </div>
      </div>

      <!-- Acciones restringidas -->
      @if (getRestrictedActions().length > 0) {
        <div class="actions-group">
          <h3>ğŸ”’ Acciones Restringidas</h3>
          <p class="restricted-info">
            Las siguientes acciones requieren permisos adicionales que tu rol actual no posee:
          </p>
          
          <div class="actions-grid">
            @for (action of getRestrictedActions(); track action.title) {
              <div class="action-card restricted">
                <div class="action-icon">{{ action.icon }}</div>
                <div class="action-content">
                  <h4 class="action-title">{{ action.title }}</h4>
                  <p class="action-description">{{ action.description }}</p>
                  @if (action.requiredPermission) {
                    <p class="required-permission">
                      ğŸ”‘ Requiere: {{ action.requiredPermission }}
                    </p>
                  }
                </div>
                <div class="action-lock">ğŸ”’</div>
              </div>
            }
          </div>
        </div>
      }
    </section>

    <!-- ğŸ“ˆ Actividad reciente y eventos -->
    <aside class="sidebar">
      <!-- ğŸ“ˆ Actividad reciente -->
      <section class="activity-section">
        <h3>ğŸ“ˆ Actividad Reciente</h3>
        
        <div class="activity-list">
          @for (activity of recentActivity; track $index) {
            <div class="activity-item">
              <div class="activity-icon">{{ activity.icon }}</div>
              <div class="activity-content">
                <p class="activity-action">{{ activity.action }}</p>
                <span class="activity-time">{{ activity.time }} atrÃ¡s</span>
              </div>
            </div>
          }
        </div>
      </section>

      <!-- ğŸš¨ Eventos de seguridad -->
      <section class="security-section">
        <h3>ğŸš¨ Eventos de Seguridad</h3>
        
        @if (securityEvents.length === 0) {
          <div class="no-events">
            <p>âœ… No hay eventos de seguridad recientes</p>
          </div>
        } @else {
          <div class="security-list">
            @for (event of securityEvents; track $index) {
              <div class="security-item" [class]="getSecurityEventClass(event)">
                <div class="event-header">
                  <span class="event-type">{{ getSecurityEventDescription(event) }}</span>
                  <span class="event-time">{{ formatTimestamp(event.timestamp) }}</span>
                </div>
                
                @if (event.userId) {
                  <div class="event-details">
                    <small>Usuario ID: {{ event.userId }}</small>
                  </div>
                }
              </div>
            }
          </div>
        }
      </section>
    </aside>
  </div>

  <!-- ğŸ“ InformaciÃ³n sobre Guards y Lazy Loading -->
  <section class="educational-section">
    <h2>ğŸ“ LAB 4: Guards y Lazy Loading Demostrados</h2>
    
    <div class="concepts-grid">
      <div class="concept">
        <h4>ğŸ›¡ï¸ AuthGuard</h4>
        <p>Protege rutas requiriendo autenticaciÃ³n</p>
        <ul>
          <li>âœ… CanActivate</li>
          <li>âœ… CanActivateChild</li>
          <li>âœ… CanLoad para lazy modules</li>
          <li>âœ… RedirecciÃ³n a login</li>
        </ul>
      </div>
      
      <div class="concept">
        <h4>ğŸ‘‘ AdminGuard</h4>
        <p>Verifica permisos especÃ­ficos de administrador</p>
        <ul>
          <li>âœ… VerificaciÃ³n de rol</li>
          <li>âœ… Permisos granulares</li>
          <li>âœ… PÃ¡gina de acceso denegado</li>
          <li>âœ… Logging de intentos</li>
        </ul>
      </div>
      
      <div class="concept">
        <h4>âš ï¸ UnsavedChangesGuard</h4>
        <p>Previene pÃ©rdida de datos no guardados</p>
        <ul>
          <li>âœ… CanDeactivate</li>
          <li>âœ… ConfirmaciÃ³n personalizada</li>
          <li>âœ… Interface para componentes</li>
          <li>âœ… Manejo async</li>
        </ul>
      </div>
      
      <div class="concept">
        <h4>ğŸ“¦ Lazy Loading</h4>
        <p>Este mÃ³dulo se carga bajo demanda</p>
        <ul>
          <li>âœ… MÃ³dulo separado</li>
          <li>âœ… Carga diferida</li>
          <li>âœ… Guards en rutas lazy</li>
          <li>âœ… OptimizaciÃ³n de bundle</li>
        </ul>
      </div>
    </div>
    
    <div class="demo-info">
      <h4>ğŸ’¡ Prueba los Guards</h4>
      <div class="demo-actions">
        <p><strong>ğŸ” AuthGuard:</strong> Cierra sesiÃ³n e intenta acceder a rutas protegidas</p>
        <p><strong>ğŸ‘‘ AdminGuard:</strong> Inicia sesiÃ³n con un rol diferente a admin</p>
        <p><strong>âš ï¸ UnsavedChangesGuard:</strong> Modifica un formulario y trata de navegar</p>
        <p><strong>ğŸ“¦ Lazy Loading:</strong> Observa las herramientas de desarrollador - este mÃ³dulo se carga por separado</p>
      </div>
    </div>
  </section>

  <!-- ğŸ” InformaciÃ³n de permisos del usuario actual -->
  <section class="permissions-section">
    <h2>ğŸ” Tus Permisos Actuales</h2>
    
    @if (currentUser) {
      <div class="permissions-info">
        <div class="user-summary">
          <h3>ğŸ‘¤ {{ currentUser.fullName }}</h3>
          <p><strong>Rol:</strong> {{ currentUser.role }}</p>
          <p><strong>Email:</strong> {{ currentUser.email }}</p>
          <p><strong>Ãšltimo acceso:</strong> {{ formatTimestamp(currentUser.lastLogin) }}</p>
        </div>
        
        <div class="permissions-list">
          <h4>ğŸ”‘ Permisos Asignados ({{ currentUser.permissions.length }}):</h4>
          <div class="permissions-grid">
            @for (permission of currentUser.permissions; track permission) {
              <span class="permission-badge">{{ permission }}</span>
            }
          </div>
        </div>
      </div>
    }
  </section>
</div>