<div class="projects-container">
  <header class="page-header">
    <div class="header-content">
      <h1>ğŸ—ï¸ GestiÃ³n de Proyectos</h1>
      <p class="page-description">
        Esta pÃ¡gina estÃ¡ protegida por <code>AuthGuard</code> - Solo usuarios autenticados
      </p>
    </div>
    
    <div class="header-actions">
      <button class="btn btn-secondary" (click)="goToDashboard()">
        ğŸ  Dashboard
      </button>
      <button class="btn btn-danger" (click)="logout()">
        ğŸšª Salir
      </button>
    </div>
  </header>

  <!-- ğŸ—ï¸ Lista de proyectos -->
  <section class="projects-section">
    <h2>ğŸ“‹ Proyectos PROVIAS</h2>
    
    <div class="projects-grid">
      @for (project of projects; track project.id) {
        <div class="project-card" [class]="project.status">
          <div class="project-header">
            <h3>{{ project.name }}</h3>
            <span class="project-status" [class]="project.status">
              {{ getStatusText(project.status) }}
            </span>
          </div>
          
          <div class="project-details">
            <p class="project-location">
              ğŸ“ <strong>UbicaciÃ³n:</strong> {{ project.location }}
            </p>
            <p class="project-budget">
              ğŸ’° <strong>Presupuesto:</strong> {{ formatBudget(project.budget) }}
            </p>
          </div>
        </div>
      }
    </div>
  </section>

  <!-- ğŸ” VerificaciÃ³n de permisos -->
  <section class="permissions-check">
    <h2>ğŸ” VerificaciÃ³n de Permisos</h2>
    
    <div class="permissions-grid">
      <div class="permission-item">
        <h4>ğŸ‘€ Ver Proyectos</h4>
        @if (hasPermission('projects:view')) {
          <span class="permission-granted">âœ… Tienes acceso</span>
          <p>Puedes ver la informaciÃ³n de todos los proyectos</p>
        } @else {
          <span class="permission-denied">âŒ Sin acceso</span>
          <p>No tienes permisos para ver proyectos</p>
        }
      </div>
      
      <div class="permission-item">
        <h4>âœï¸ Editar Proyectos</h4>
        @if (hasPermission('projects:edit')) {
          <span class="permission-granted">âœ… Tienes acceso</span>
          <p>Puedes modificar la informaciÃ³n de proyectos</p>
        } @else {
          <span class="permission-denied">âŒ Sin acceso</span>
          <p>No tienes permisos para editar proyectos</p>
        }
      </div>
      
      <div class="permission-item">
        <h4>â• Crear Proyectos</h4>
        @if (hasPermission('projects:create')) {
          <span class="permission-granted">âœ… Tienes acceso</span>
          <p>Puedes crear nuevos proyectos en el sistema</p>
        } @else {
          <span class="permission-denied">âŒ Sin acceso</span>
          <p>No tienes permisos para crear proyectos</p>
        }
      </div>
      
      <div class="permission-item">
        <h4>ğŸ—‘ï¸ Eliminar Proyectos</h4>
        @if (hasPermission('projects:delete')) {
          <span class="permission-granted">âœ… Tienes acceso</span>
          <p>Puedes eliminar proyectos del sistema</p>
        } @else {
          <span class="permission-denied">âŒ Sin acceso</span>
          <p>No tienes permisos para eliminar proyectos</p>
        }
      </div>
    </div>
  </section>

  <!-- ğŸ“Š EstadÃ­sticas por estado -->
  <section class="stats-section">
    <h2>ğŸ“Š EstadÃ­sticas de Proyectos</h2>
    
    <div class="stats-grid">
      <div class="stat-card planning">
        <div class="stat-icon">ğŸ“‹</div>
        <div class="stat-info">
          <h3>{{ projects.filter(p => p.status === 'planning').length }}</h3>
          <p>En PlanificaciÃ³n</p>
        </div>
      </div>
      
      <div class="stat-card in-progress">
        <div class="stat-icon">ğŸš§</div>
        <div class="stat-info">
          <h3>{{ projects.filter(p => p.status === 'in-progress').length }}</h3>
          <p>En EjecuciÃ³n</p>
        </div>
      </div>
      
      <div class="stat-card completed">
        <div class="stat-icon">âœ…</div>
        <div class="stat-info">
          <h3>{{ projects.filter(p => p.status === 'completed').length }}</h3>
          <p>Completados</p>
        </div>
      </div>
    </div>
  </section>

  <!-- ğŸ“ InformaciÃ³n educativa -->
  <section class="educational-section">
    <h2>ğŸ“ AuthGuard en Funcionamiento</h2>
    
    <div class="guard-info">
      <div class="guard-step">
        <div class="step-number">1</div>
        <div class="step-content">
          <h4>ğŸ” VerificaciÃ³n de AutenticaciÃ³n</h4>
          <p>AuthGuard verificÃ³ que tienes una sesiÃ³n vÃ¡lida antes de mostrar esta pÃ¡gina</p>
        </div>
      </div>
      
      <div class="guard-step">
        <div class="step-number">2</div>
        <div class="step-content">
          <h4>ğŸ« ValidaciÃ³n de Token</h4>
          <p>Se verificÃ³ que tu token de sesiÃ³n no haya expirado</p>
        </div>
      </div>
      
      <div class="guard-step">
        <div class="step-number">3</div>
        <div class="step-content">
          <h4>ğŸ“¦ Carga del Componente</h4>
          <p>Solo despuÃ©s de la verificaciÃ³n exitosa se cargÃ³ este componente via lazy loading</p>
        </div>
      </div>
      
      <div class="guard-step">
        <div class="step-number">4</div>
        <div class="step-content">
          <h4>ğŸ” Control de Permisos</h4>
          <p>La UI se adapta dinÃ¡micamente segÃºn tus permisos especÃ­ficos</p>
        </div>
      </div>
    </div>
    
    <div class="test-info">
      <h4>ğŸ§ª Prueba el Guard</h4>
      <p>
        Para probar AuthGuard, cierra sesiÃ³n e intenta acceder directamente a esta URL.
        SerÃ¡s redirigido automÃ¡ticamente a la pÃ¡gina de login.
      </p>
      <button class="test-logout-btn" (click)="logout()">
        ğŸšª Probar AuthGuard (Cerrar SesiÃ³n)
      </button>
    </div>
  </section>
</div>